///
/// @group Users
/// @since 1.0
/// @author Lionel PÃ©ramo
///

// loading SASS modules
@use 'sass:map';

// Loading EcoComposer themes
@use 'bundles/resources/scss/configuration/components/themes/select' as selectThemes;
@use 'bundles/resources/scss/configuration/components/themes/table' as tableThemes;

// loading EcoComposer components
@use 'scss/components/select/select';
@use 'scss/components/theming/theming';
@use 'scss/components/table/table';

$-defaults : (
  'themes' : (
    'light': (
      'default--login-form--background-color' : #eee,
    ),
    'dark': (
      'default--login-form--background-color' : #333,
    )
  )
);

///
/// Main mixin that initializes the users management page component.
///
/// @access public
@mixin init() {
  html[data-page="users-page"] {
    @at-root {
      @media (min-width : 700px) {
        .table--link {
          background      : none;
          border          : 0;
          cursor          : pointer;
          font-size       : inherit;
          padding         : 0;
          text-decoration : underline;
        }
      }
    }

    th {
      padding: 1rem * theming.$font-size;
    }

    tr {
      & > td {
        &:nth-child(2) {
          vertical-align : top;
        }
      }

      @at-root html[data-page="users-page"] .table--row--links {
        transition  : opacity .25s ease-in-out;
        will-change : opacity;
      }

      &:hover .table--row--links {
        opacity : 1;
      }

      &:not(:hover) .table--row--links {
        opacity : 0;
      }
    }
  }
}

///
/// Main mixin that creates login pages.
///
/// @access public
/// @param  {array} $-options ()
///
@mixin create($-options : ()) {
  $-themeUsed: map.has-key($-options, 'themes');
  $-options : map.merge($-defaults, $-options);
  $-themes : theming.merge-themes(
    (
      map.get($-options, 'themes'),
      selectThemes.$themes,
      tableThemes.$themes
    )
  );

  $-themes: theming.merge-themes(
    (
      $-themes,
      selectThemes.$themes,
      tableThemes.$themes
    )
  );

  @include select.init();
  @include select.create(
    (
      'select--container--background-color' : null,
      'select--container--background-image' : null,
      'themes' : $-themes
    )
  );
  @include table.init();
  @include table.create(
    (
      'desktop--th-padding' : 1rem * theming.$font-size,
      'mobile--th-padding' : 1rem * theming.$font-size,
      'desktop--td-padding' : 1rem * theming.$font-size,
      'mobile--td-padding' : 1rem * theming.$font-size,
      'table--border' : null,
      'table--td--border' : null,
      'table--th--border' : null,
      'themes' : $-themes
    )
  );

  html[data-page="users-page"] {
    @include theming.to-theme((#{&} : ('background-color', 'users--background-color')));

    @at-root .table--link {
      @include theming.to-theme((#{&} : ('color', 'users--table--action-link--color')));
    }

    thead > tr {
      @include theming.to-theme((#{&} : ('background-image', 'users--tr-n-plus-one--background-image')));
    }

    tbody > tr {
      &:nth-child(2n+1) {
        @include theming.to-theme((#{&} : ('background-image', 'users--tr-n--background-image')));
      }

      &:nth-child(2n) {
        @include theming.to-theme((#{&} : ('background-image', 'users--tr-n-plus-one--background-image')));
      }

      @at-root html[data-page="users-page"] a {
        @include theming.to-theme((#{&} : ('color', 'users--table--link--color')));
      }
    }
  }
}
